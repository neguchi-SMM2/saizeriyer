<!DOCTYPE html>
<html>
    <head>
        <title>Saizeriyer</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="icon" type="image/x-icon" href="favicon.ico">
        <link rel="stylesheet" href="styles.css">
    </head>
    <body>
        <h1>ã‚µã‚¤ã‚¼ãƒ¡ãƒ‹ãƒ¥ãƒ¼çµ„ã¿åˆã‚ã›ç”Ÿæˆæ©Ÿ</h1>
        <p class="info">æŒ‡å®šã•ã‚ŒãŸæ¡ä»¶ã‚’æº€ãŸã™ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®çµ„ã¿åˆã‚ã›ã‚’ç”Ÿæˆã—ã¾ã™ã€‚</p>
        <fieldset>
            <legend>æ¡ä»¶</legend>
            <div>
                <label for="min_price">å€¤æ®µ:</label>
                <input type="number" id="price" name="price" value="1000" min="0" />
            </div>
            <div>
                <input type="checkbox" id="alcohol" name="alcohol" />
                <label for="alcohol">ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«ã‚’å«ã‚€</label>
            </div>
            <div>
                <input type="checkbox" id="duplicate" name="duplicate" />
                <label for="duplicate">é‡è¤‡ã‚’è¨±å¯</label>
            </div>
            <div>
                <input type="checkbox" id="lunch" name="lunch" />
                <label for="lunch">ãƒ©ãƒ³ãƒãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’å«ã‚€</label>
            </div>
            <br>
            <button id="generate">ç”Ÿæˆ</button>
        </fieldset>

        <div id="result">ã“ã“ã«çµæœãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</div>
        <script>
        let menuData = [];

        // JSONèª­ã¿è¾¼ã¿
        fetch("data.json")
        .then(res => res.json())
        .then(data => {
            menuData = data;
        });

        document.getElementById('generate').addEventListener('click', function () {
        const price = parseInt(document.getElementById('price').value, 10);
        const alcohol = document.getElementById('alcohol').checked;
        const duplicate = document.getElementById('duplicate').checked;
        const lunch = document.getElementById('lunch').checked;

        const resultDiv = document.getElementById('result');
        resultDiv.innerHTML = "<p>ç”Ÿæˆä¸­...</p>"; // ğŸ”¹ ä¸€æ™‚è¡¨ç¤º

        setTimeout(() => {
            // æ¡ä»¶ã§ãƒ•ã‚£ãƒ«ã‚¿
            let filtered = menuData.filter(item => {
            if (!alcohol && item.type === "alcohol") return false;
            if (!lunch && item.type === "lunch") return false;
            return true;
            });

            let candidates = [];

            function dfs(start, combo, total) {
            if (total > price) return;

            // âœ… æ¡ä»¶: äºˆç®—-100 < total <= äºˆç®—
            if (total > price - 100 && total <= price && combo.length > 0) {
                candidates.push({ items: [...combo], total });
            }

            for (let i = start; i < filtered.length; i++) {
                const item = filtered[i];

                // ãƒ©ãƒ³ãƒã¯1å“ã¾ã§
                if (item.type === "lunch" && combo.some(c => c.type === "lunch")) continue;

                combo.push(item);
                dfs(duplicate ? i : i + 1, combo, total + item.price);
                combo.pop();
            }
            }

            dfs(0, [], 0);

            // çµæœè¡¨ç¤º
            resultDiv.innerHTML = "";
            if (candidates.length === 0) {
            resultDiv.textContent = "æ¡ä»¶ã«åˆã†çµ„ã¿åˆã‚ã›ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚";
            } else {
            const choice = candidates[Math.floor(Math.random() * candidates.length)];

            choice.items.forEach(i => {
                const p = document.createElement("p");
                p.textContent = `${i.id} - ${i.name}`;
                resultDiv.appendChild(p);
            });

            const totalP = document.createElement("p");
            totalP.textContent = `åˆè¨ˆï¼š${choice.total}å††`;
            resultDiv.appendChild(totalP);
            }
        }, 50); // ğŸ”¹ å°‘ã—é…å»¶ã•ã›ã¦ã€Œç”Ÿæˆä¸­...ã€ãŒè¦‹ãˆã‚‹ã‚ˆã†ã«ã™ã‚‹
        });
        </script>
    </body>
</html>
